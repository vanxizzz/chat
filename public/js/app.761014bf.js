(function(t){function e(e){for(var a,s,i=e[0],c=e[1],u=e[2],d=0,f=[];d<i.length;d++)s=i[d],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&f.push(o[s][0]),o[s]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);l&&l(e);while(f.length)f.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],a=!0,i=1;i<n.length;i++){var c=n[i];0!==o[c]&&(a=!1)}a&&(r.splice(e--,1),t=s(s.s=n[0]))}return t}var a={},o={app:0},r=[];function s(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=a,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(n,a,function(e){return t[e]}.bind(null,a));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var u=0;u<i.length;u++)e(i[u]);var l=c;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0be3":function(t,e,n){n("d3b7"),t.exports=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise((function(e){setTimeout((function(){e()}),t)}))}},"0eb2":function(t,e,n){},"0f01":function(t,e,n){"use strict";n("999b")},1:function(t,e){},"18c4":function(t,e,n){},2004:function(t,e,n){},2336:function(t,e,n){},"2deb":function(t,e,n){"use strict";n("2004")},"2f32":function(t,e,n){},3930:function(t,e,n){},"4c32":function(t,e,n){"use strict";n("0eb2")},"50a2":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},r=[],s=(n("96cf"),n("1da1")),i={mounted:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("?????????"),e.prev=1,e.next=4,t.$apis.whoami();case 4:n=e.sent,console.log("rrrrrrrrresp"),console.log(n),n.status&&(t.$store.commit("user/login",n.data),t.$router.push("/")),e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](1),console.log(e.t0),console.log("识别失败");case 14:return e.prev=14,e.finish(14);case 16:case"end":return e.stop()}}),e,null,[[1,10,14,16]])})))()},beforeDestroy:function(){this.$socket.disconnect()}},c=i,u=(n("5c0b"),n("2877")),l=Object(u["a"])(c,o,r,!1,null,null,null),d=l.exports,f=n("8c4f"),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home"},[n("div",{staticClass:"wrapper"},[n("Left"),n("Right")],1),n("div",{staticClass:"alertInfo"})])},g=[],h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"left"},[n("Header"),n("Functions"),n("Relation")],1)},m=[],v=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"my"},[n("div",{staticClass:"myWrapper"},[n("img",{staticClass:"avatar",attrs:{src:t.info.avatar}}),n("span",{staticClass:"name"},[t._v(t._s(t.info.name)+t._s(t.info.account))])]),t._m(0)])},b=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"config"},[n("span",{staticClass:"iconfont configIcon",staticStyle:{color:"#777777"}})])}],y=(n("b0c0"),n("5530")),C={computed:{info:function(){var t=this.$store.state.user.info.name;return t.length>10&&(t=t.substr(0,10)+"..."),Object(y["a"])(Object(y["a"])({},this.$store.state.user.info),{},{name:t})}}},w=C,k=(n("839a"),Object(u["a"])(w,v,b,!1,null,null,null)),x=k.exports,_=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},I=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"searchBar"},[n("div",{staticClass:"searchWrapper"},[n("span",{staticClass:"iconfont searchIcon icon"}),n("input",{staticClass:"inp",attrs:{type:"text",placeholder:"搜索"}})])])}],$=n("2f62"),O={computed:Object(y["a"])({},Object($["b"])("user",["info"]))},j=O,F=(n("e6cf1"),Object(u["a"])(j,_,I,!1,null,null,null)),R=F.exports,S=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"relation"},[n("div",{staticClass:"relationWrapper"},[n("vue-custom-scrollbar",{staticClass:"scroll-area",attrs:{settings:t.settings}},[n("div",{staticClass:"wrapper"},[t._l(t.friends,(function(e){return n("div",{key:"user "+e.id,class:{item:!0,cur:e.id===t.target.targetId},on:{click:function(n){return t.chat("user",e.id)}}},[n("img",{staticClass:"avatar",attrs:{src:e.avatar,alt:""}}),n("span",{staticClass:"name"},[t._v(t._s(e.name))])])})),t._l(t.groups,(function(e){return n("div",{key:"group "+e.group_id,class:{item:!0,cur:e.id===t.target.targetId},on:{click:function(n){return t.chat("group",e.group_id)}}},[n("img",{staticClass:"avatar",attrs:{src:e.avatar,alt:""}}),n("span",{staticClass:"name"},[t._v(t._s(e.name))])])}))],2)])],1)])},T=[],M=(n("99af"),n("d81d"),n("2909")),L={data:function(){return{settings:{wheelSpeed:.2}}},computed:{target:function(){return this.$store.state.chatting.curChattingTarget},friends:function(){return this.$store.state.user.info.friends.map((function(t){var e=t.name;return e.length>10&&(e=t.name.substr(0,10)+"..."),Object(y["a"])(Object(y["a"])({},t),{},{name:e})}))},groups:function(){return this.$store.state.user.info.groups.map((function(t){var e=t.name;return e.length>10&&(e=t.name.substr(0,10)+"..."),Object(y["a"])(Object(y["a"])({},t),{},{name:e})}))},relations:function(){return[].concat(Object(M["a"])(this.friends()),Object(M["a"])(this.groups()))}},methods:{chat:function(t,e){console.log(t),console.log(e);var n=this.$store.state.user.info.id,a=this.$store.state.chatting.curChattingTarget,o=a.limit,r=a.page;this.$socket.emit("getChatting",{type:t,targetId:e,myId:n,limit:o,page:r,getAll:!0})}}},A=L,D=(n("8e2d"),Object(u["a"])(A,S,T,!1,null,null,null)),B=D.exports,E=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"funcs"},[n("div",{staticClass:"itemWrapper"},t._l(t.funcs,(function(e,a){return n("div",{key:e.id,staticClass:"item"},[n("a",{class:"iconfont "+e.icon+" icon",style:e.style?e.style:{},attrs:{href:"#",title:e.title},on:{click:function(e){return e.preventDefault(),t.alertPrompt(a)}}})])})),0),n("div",{staticClass:"alertPage"},[n("el-dialog",{key:"1",attrs:{visible:t.dialogVisible[0],width:"30%"},on:{"update:visible":function(e){return t.$set(t.dialogVisible,0,e)},close:function(e){return t.initForm(0)}},scopedSlots:t._u([{key:"title",fn:function(){return[n("span",[t._v("通过账号添加好友")])]},proxy:!0},{key:"default",fn:function(){return[n("div",{staticClass:"item"},[n("el-input",{attrs:{placeholder:"请输入对方账号"},model:{value:t.dialogInput[0].accountValue,callback:function(e){t.$set(t.dialogInput[0],"accountValue",e)},expression:"dialogInput[0].accountValue"}})],1),n("div",{staticClass:"item"},[n("vue-custom-scrollbar",{staticClass:"infoScrollBar"},[n("el-input",{staticClass:"infoInput",attrs:{type:"textarea","show-word-limit":"",placeholder:"请输入验证信息。。。",resize:"none"},model:{value:t.dialogInput[0].info,callback:function(e){t.$set(t.dialogInput[0],"info",e)},expression:"dialogInput[0].info"}})],1)],1)]},proxy:!0},{key:"footer",fn:function(){return[n("span",{staticClass:"dialog-footer"},[n("el-button",{on:{click:t.hideDialog}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),t.confirmAddFriend(e)}}},[t._v("确 定")])],1)]},proxy:!0}])}),n("el-dialog",{key:"2",attrs:{visible:t.dialogVisible[1],width:"30%"},on:{"update:visible":function(e){return t.$set(t.dialogVisible,1,e)},close:function(e){return t.initForm(1)}},scopedSlots:t._u([{key:"title",fn:function(){return[n("span",[t._v("请选择好友添加")])]},proxy:!0},{key:"default",fn:function(){return[n("div",{staticClass:"item"},[n("vue-custom-scrollbar",{staticClass:"friendsScrollBar"},[n("div",{staticClass:"checkboWrapper"},t._l(t.friends,(function(e){return n("div",{key:e.id,staticClass:"checkboxItem"},[n("el-checkbox",{staticStyle:{width:"100%"},attrs:{value:t.isChecked(e.id),label:e.name},on:{change:function(n){return t.updateCheckbox(e.id)}}})],1)})),0)])],1),n("div",{staticClass:"item"},[n("el-input",{attrs:{placeholder:"请输入创建的群名"},model:{value:t.dialogInput[1].groupName,callback:function(e){t.$set(t.dialogInput[1],"groupName",e)},expression:"dialogInput[1].groupName"}})],1)]},proxy:!0},{key:"footer",fn:function(){return[n("span",{staticClass:"dialog-footer"},[n("el-button",{on:{click:t.hideDialog}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.confirmAddGroup}},[t._v("确 定")])],1)]},proxy:!0}])}),n("el-dialog",{attrs:{visible:t.dialogVisible[2],width:"30%"},on:{"update:visible":function(e){return t.$set(t.dialogVisible,2,e)},close:function(e){return t.initForm(2)}},scopedSlots:t._u([{key:"title",fn:function(){return[n("span",[t._v("修改个人信息")])]},proxy:!0},{key:"default",fn:function(){return[n("el-form",{attrs:{model:t.dialogInput[2],"label-width":"50px"}},[n("el-form-item",{attrs:{label:"账号"}},[n("el-input",{attrs:{disabled:"",value:t.dialogInput[2].account}})],1),n("el-form-item",{attrs:{label:"姓名"}},[n("el-input",{model:{value:t.dialogInput[2].name,callback:function(e){t.$set(t.dialogInput[2],"name",e)},expression:"dialogInput[2].name"}})],1),n("el-form-item",{attrs:{label:"头像"}},[n("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http://localhost:9527/api/avatar","show-file-list":!1,multiple:!1,name:"avatar","on-success":t.successUploadImg,headers:t.myHeaders}},[t.dialogInput[2].avatar?n("img",{staticClass:"avatar",attrs:{src:t.dialogInput[2].avatar}}):n("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),n("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1)],1)],1)]},proxy:!0},{key:"footer",fn:function(){return[n("span",{staticClass:"dialog-footer"},[n("el-button",{on:{click:t.hideDialog}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.confirmUpdateInfo}},[t._v("修 改")])],1)]},proxy:!0}])})],1)])},G=[],W=(n("4de4"),n("c740"),n("caad"),n("2532"),n("5c96")),P=n.n(W),V={created:function(){var t=this.$store.state.user.info,e=t.account,n=t.name,a=t.avatar;this.dialogInput[2].account=e,this.dialogInput[2].name=n,this.dialogInput[2].avatar=a,console.log("createddddddd"),console.log(this.dialogInput[2])},data:function(){return{myHeaders:{authorization:localStorage.token},dialogVisible:{0:!1,1:!1,2:!1},dialogInput:[{accountValue:"",info:""},{groupName:""},{account:"",name:"",avatar:""}],groupName:"",curCheckedListId:[],funcs:[{id:0,title:"添加好友",icon:"friendIcon",style:{color:"#f40"}},{id:1,title:"添加群",icon:"groupIcon",style:{color:"#02B6FD"}},{id:2,title:"修改个人信息",icon:"editIcon"}]}},computed:{friends:function(){return this.$store.state.user.info.friends}},methods:{confirmUpdateInfo:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,a,o,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("确定修改吗"),console.log(t.dialogInput[2]),e.next=4,t.$apis.updateMyInfo(Object(y["a"])({},t.dialogInput[2]));case 4:n=e.sent,t.dialogVisible[2]=!1,console.log("返回的结果"),console.log(n),t.$message({message:n.msg,type:n.status?"success":"error"}),n.status&&(a=n.data,o=a.name,r=a.avatar,t.$store.commit("user/updateMyInfo",{name:o,avatar:r}),t.$socket.emit("updateMyInfo"),t.$socket.emit("getAllChattingRecord",{getAll:!0}),t.$root.$forceUpdate());case 10:case"end":return e.stop()}}),e)})))()},initForm:function(t){if(2===t){var e=this.$store.state.user.info,n=e.account,a=e.name,o=e.avatar;return this.dialogInput[2].account=n,this.dialogInput[2].name=a,void(this.dialogInput[2].avatar=o)}var r=this.dialogInput[t];for(var s in r)r[s]=""},successUploadImg:function(t){t.status&&(this.dialogInput[2].avatar=t.data.imgSrc),console.log("上传成功")},isChecked:function(t){return console.log("this.curCheckedListId"),console.log(this.curCheckedListId),this.curCheckedListId.includes(t)},updateCheckbox:function(t){var e=this.curCheckedListId.findIndex((function(e){return e===t}));-1!==e?this.curCheckedListId=this.curCheckedListId.filter((function(e){return e!==t})):this.curCheckedListId.push(t)},confirmAddFriend:function(){var t=this.dialogInput[0],e=t.accountValue,n=t.info;this.$socket.emit("enquireAddFriend",{targetAccount:e,info:n}),this.hideDialog()},confirmAddGroup:function(){var t=this;console.log("结果"),console.log(this.curCheckedListId);var e=this.friends.filter((function(e){return t.curCheckedListId.includes(e.id)}));this.$socket.emit("addGroup",{groupData:{name:this.dialogInput[1].groupName},inviteTarget:e}),this.curCheckedListId=[],this.hideDialog()},hideDialog:function(){for(var t in this.dialogVisible)this.dialogVisible[t]=!1},alertPrompt:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.hideDialog(),e.dialogVisible[t]=!0,console.log(e.dialogVisible),n.abrupt("return");case 9:a=n.sent,o=a.value,e.$store.state.user.info.id,console.log(o),n.next=16;break;case 15:1===t&&(e.dialogVisible=!0);case 16:n.next=20;break;case 18:n.prev=18,n.t0=n["catch"](5);case 20:case"end":return n.stop()}}),n,null,[[5,18]])})))()}}},N=V,q=(n("8374"),Object(u["a"])(N,E,G,!1,null,"437e1b77",null)),U=q.exports,H={components:{Header:x,SearchBar:R,Relation:B,Functions:U}},z=H,J=(n("ed9f"),Object(u["a"])(z,h,m,!1,null,"b4559dee",null)),X=J.exports,Y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"right"},[null==t.curChattingTarget.targetId?[t._m(0)]:[n("div",{staticClass:"wrapper"},[n("Header"),n("ChattingRecord"),n("RichText")],1)]],2)},K=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"noChat"},[n("div",{staticClass:"iconfont wechatIcon wechat"}),n("p",[t._v("未选中聊天")])])}],Q=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"header"},[n("div",{staticClass:"content"},[n("div",{staticClass:"box"},[n("div",{staticClass:"name"},[t._v(t._s(t.name))]),n("div",{staticClass:"iconfont bottomArrowIcon"})])])])},Z=[],tt=(n("7db0"),{computed:{name:function(){var t,e=this.$store.state,n=e.chatting.curChattingTarget,a=n.type,o=n.targetId;return console.log("targetIddddddd"),console.log(o),"user"===a?t=e.user.info.friends.find((function(t){return t.id===o})):"group"===a&&(t=e.user.info.groups.find((function(t){return t.group_id===o}))),t?t.name:""}},components:{}}),et=tt,nt=(n("2deb"),Object(u["a"])(et,Q,Z,!1,null,"e56ac928",null)),at=nt.exports,ot=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("EnhanceVueScrollBar",{staticClass:"chattingScrolBar",attrs:{settings:t.settings}},[n("div",{staticClass:"chattingRecord"},["user"===t.type?t._l(t.chattingData,(function(e){return n("RecordItem",{key:e.id,attrs:{info:e.info,avatar:e.sendUserData.avatar,direction:e.send_id===t.myId?"right":"left",name:e.sendUserData.avatar.name,chatType:t.type}})})):"group"===t.type?t._l(t.chattingData,(function(e){return n("RecordItem",{key:e.id,attrs:{info:e.info,avatar:e.sendUserData.avatar,direction:e.send_id===t.myId?"right":"left",name:e.sendUserData.name,chatType:t.type}})})):t._e()],2)])},rt=[],st=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("vue-custom-scrollbar",{ref:"bar",attrs:{settings:t.settings,swicher:t.swicher,tagname:t.tagname}},[t._t("default")],2)},it=[],ct={data:function(){return{mySettings:{}}},props:{settings:{default:null},swicher:{type:Boolean,default:!0},tagname:{type:String,default:"section"}},updated:function(){var t=this;this.$nextTick().then((function(){console.log("增强了零零零零"),t.$refs.bar.$el.scrollTop=99999999999}))},mounted:function(){var t=this;this.$nextTick().then((function(){console.log("增强了零零零零"),t.$refs.bar.$el.scrollTop=99999999999}))}},ut=ct,lt=Object(u["a"])(ut,st,it,!1,null,null,null),dt=lt.exports,ft=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:"recordItem "+t.direction},[n("div",{staticClass:"avatar"},[n("img",{staticClass:"avatarImg",attrs:{src:t.avatar,alt:""}})]),n("div",{staticClass:"info"},["group"===t.chatType&&"left"===t.direction?n("div",{staticClass:"name"},[t._v(" "+t._s(t.name)+" ")]):t._e(),n("div",{staticClass:"word"},[t._v(t._s(t.info))])])])},pt=[],gt={props:{info:{type:String},avatar:{type:String},direction:{default:"left",validator:function(t){return["left","right"].includes(t)}},name:{type:String},chatType:{default:"user",validator:function(t){return["user","group"].includes(t)}}}},ht=gt,mt=(n("ace9"),Object(u["a"])(ht,ft,pt,!1,null,"19be7bdd",null)),vt=mt.exports,bt={data:function(){return{settings:{wheelSpeed:.3}}},methods:{getSendData:function(t,e){var n,a=this.$store.state.user.info.id;return a===e?this.$store.state.user.info:("user"===t?n=this.$store.state.user.info.friends.find((function(t){return t.id===e})):"group"===t&&(n=this.$store.state.user.info.groups.find((function(t){return t.user_id===e}))),console.log(t,e,this.$store.state.user.info.groups),console.log("resssssssss"),console.log(n),n)}},components:{RecordItem:vt,EnhanceVueScrollBar:dt},computed:{chattingData:function(){return console.log("????????????????????????????????======="),this.$store.state.chatting.curChattingTarget.data},type:function(){return this.$store.state.chatting.curChattingTarget.type},myId:function(){return this.$store.state.user.info.id}},mounted:function(){console.log("this.chattingData"),console.log(this.chattingData)}},yt=bt,Ct=(n("4c32"),Object(u["a"])(yt,ot,rt,!1,null,"57ebf856",null)),wt=Ct.exports,kt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"richText"},[n("div",{staticClass:"toolBar"}),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.val,expression:"val"}],staticClass:"textArea",domProps:{value:t.val},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendChatting(e)},input:function(e){e.target.composing||(t.val=e.target.value)}}}),n("div",{staticClass:"sendWrapper"},[n("div",{staticClass:"box"},[n("button",{staticClass:"sendBtn",on:{click:t.sendChatting}},[t._v("发送")])])])])},xt=[],_t={data:function(){return{val:""}},methods:{sendChatting:function(){var t=this.val,e=this.$store.state,n=e.chatting.curChattingTarget,a=n.targetId,o=n.type,r=e.user.info.id;console.log(r,a,t),"user"===o?this.$socket.emit("sendUserChatting",{myId:r,targetId:a,info:t}):"group"===o&&this.$socket.emit("sendGroupChatting",{myId:r,targetId:a,info:t}),this.val=""}}},It=_t,$t=(n("7e68"),Object(u["a"])(It,kt,xt,!1,null,"4d7c2f2e",null)),Ot=$t.exports,jt={components:{Header:at,ChattingRecord:wt,RichText:Ot},computed:Object(y["a"])({},Object($["b"])("chatting",["curChattingTarget"]))},Ft=jt,Rt=(n("0f01"),Object(u["a"])(Ft,Y,K,!1,null,"54c03774",null)),St=Rt.exports,Tt={name:"Home",data:function(){return{account:"",password:"",userName:""}},methods:{},components:{Left:X,Right:St},mounted:function(){console.log("*****************"),this.$socket.launch()}},Mt=Tt,Lt=(n("fe81"),Object(u["a"])(Mt,p,g,!1,null,"663a5ff1",null)),At=Lt.exports,Dt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"loginBox"}},[n("h4",[t._v("登录")]),n("el-form",{ref:"loginForm",attrs:{model:t.loginForm,rules:t.loginRules,"label-width":"0px"}},[n("el-form-item",{staticStyle:{"margin-top":"40px"},attrs:{label:"",prop:"account"}},[n("el-row",[n("el-col",{attrs:{span:2}},[n("span",{staticClass:"iconfont accountIcon"})]),n("el-col",{attrs:{span:22}},[n("el-input",{staticClass:"inps",attrs:{placeholder:"账号"},model:{value:t.loginForm.account,callback:function(e){t.$set(t.loginForm,"account",e)},expression:"loginForm.account"}})],1)],1)],1),n("el-form-item",{attrs:{label:"",prop:"passWord"}},[n("el-row",[n("el-col",{attrs:{span:2}},[n("span",{staticClass:"iconfont passwordIcon"})]),n("el-col",{attrs:{span:22}},[n("el-input",{staticClass:"inps",attrs:{placeholder:"密码"},model:{value:t.loginForm.passWord,callback:function(e){t.$set(t.loginForm,"passWord",e)},expression:"loginForm.passWord"}})],1)],1)],1),n("el-form-item",{staticStyle:{"margin-top":"55px"}},[n("el-button",{staticClass:"btns",attrs:{type:"primary",round:""},on:{click:t.submitForm}},[t._v("登录")]),n("el-button",{staticClass:"btns",attrs:{type:"primary",round:""},on:{click:t.toRegisterPage}},[t._v("前往注册 "),n("span",{staticClass:"iconfont rightArrowIcon"})])],1)],1)],1)},Bt=[],Et={data:function(){return{loginForm:{account:"",passWord:""},loginRules:{account:[{required:!0,message:"请输入账号",trigger:"blur"}],passWord:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},methods:{submitForm:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,a,o,r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.loginForm,a=n.passWord,o=n.account,r=W["Loading"].service({fullscreen:!0}),e.next=4,t.$apis.login({account:o,password:a});case 4:s=e.sent,s.status?(t.$message({message:s.msg,type:"success"}),t.$store.commit("user/login",s.data),t.$router.push("/")):t.$message({message:s.msg,type:"error"}),console.log(s),r.close();case 8:case"end":return e.stop()}}),e)})))()},toRegisterPage:function(){this.$router.push("/identify/register")}},mounted:function(){}},Gt=Et,Wt=(n("b9fb"),Object(u["a"])(Gt,Dt,Bt,!1,null,"583ce674",null)),Pt=Wt.exports,Vt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"loginBox"}},[n("h4",[t._v("注册")]),n("el-form",{ref:"loginForm",attrs:{model:t.loginForm,rules:t.loginRules,"label-width":"0px"}},[n("el-form-item",{staticStyle:{"margin-top":"40px"},attrs:{label:"",prop:"userName"}},[n("el-row",[n("el-col",{attrs:{span:2}},[n("span",{staticClass:"iconfont nameIcon"})]),n("el-col",{attrs:{span:22}},[n("el-input",{staticClass:"inps",attrs:{placeholder:"用户名"},model:{value:t.loginForm.userName,callback:function(e){t.$set(t.loginForm,"userName",e)},expression:"loginForm.userName"}})],1)],1)],1),n("el-form-item",{attrs:{label:"",prop:"account"}},[n("el-row",[n("el-col",{attrs:{span:2}},[n("span",{staticClass:"iconfont accountIcon"})]),n("el-col",{attrs:{span:22}},[n("el-input",{staticClass:"inps",attrs:{placeholder:"账号"},model:{value:t.loginForm.account,callback:function(e){t.$set(t.loginForm,"account",e)},expression:"loginForm.account"}})],1)],1)],1),n("el-form-item",{attrs:{label:"",prop:"passWord"}},[n("el-row",[n("el-col",{attrs:{span:2}},[n("span",{staticClass:"iconfont passwordIcon"})]),n("el-col",{attrs:{span:22}},[n("el-input",{staticClass:"inps",attrs:{placeholder:"密码"},model:{value:t.loginForm.passWord,callback:function(e){t.$set(t.loginForm,"passWord",e)},expression:"loginForm.passWord"}})],1)],1)],1),n("el-form-item",[n("el-button",{staticClass:"btns",attrs:{type:"primary",round:""},on:{click:t.toLoginPage}},[n("span",{staticClass:"iconfont leftArrowIcon"}),t._v("返回登录")]),n("el-button",{staticClass:"btns",attrs:{type:"primary",round:""},on:{click:t.submitForm}},[t._v("注册")])],1)],1)],1)},Nt=[],qt={data:function(){return{loginForm:{userName:"",passWord:"",account:""},loginRules:{userName:[{required:!0,message:"请输入用户名",trigger:"blur"}],passWord:[{required:!0,message:"请输入密码",trigger:"blur"}],account:[{required:!0,message:"请输入账号",trigger:"blur"}]}}},methods:{toLoginPage:function(){this.$router.push("/identify/login")},submitForm:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,a,o,r,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.loginForm,a=n.passWord,o=n.userName,r=n.account,s=W["Loading"].service({fullscreen:!0}),e.prev=2,e.next=5,t.$apis.register({account:r,password:a,name:o});case 5:i=e.sent,console.log("respppppppp"),console.log(i),t.$message({message:i.msg,type:i.status?"success":"error"}),i.status&&t.$router.push("/identify/login"),s.close(),e.next=17;break;case 13:e.prev=13,e.t0=e["catch"](2),console.log("发送错误嗡嗡嗡嗡嗡嗡嗡嗡嗡了"),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[2,13]])})))()}},mounted:function(){}},Ut=qt,Ht=(n("a517"),Object(u["a"])(Ut,Vt,Nt,!1,null,"60828074",null)),zt=Ht.exports,Jt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"login"}},[n("div",{attrs:{id:"bgd"}},[n("canvas",{attrs:{id:"myCanvas",width:t.width,height:t.height}})]),n("transition",{attrs:{"enter-active-class":"animate__animated animate__fadeInRight","leave-active-class":"animated animate__fadeOutLeft"}},[n("router-view")],1)],1)},Xt=[],Yt=(n("cb29"),n("4160"),n("159b"),n("d4ec")),Kt=n("bee2"),Qt={data:function(){return{canvas:null,context:null,stars:[],shadowColorList:["#39f","#ec5707","#b031d4","#22e6c7","#92d819","#14d7f1","#e23c66"],directionList:["leftTop","leftBottom","rightTop","rightBottom"],speed:50,last_star_created_time:new Date,Ball:function(){function t(e){Object(Yt["a"])(this,t),this.x=0,this.y=0,this.radius=e,this.color="",this.shadowColor="",this.direction=""}return Object(Kt["a"])(t,[{key:"draw",value:function(t){t.save(),t.translate(this.x,this.y),t.lineWidth=this.lineWidth;var e=t.createLinearGradient(0,0,0,8);e.addColorStop(0,this.color),e.addColorStop(1,this.shadowColor),t.fillStyle=e,t.beginPath(),t.arc(0,0,this.radius,0,2*Math.PI,!0),t.closePath(),t.shadowColor=this.shadowColor,t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=10,t.fill(),t.restore()}}]),t}(),width:window.innerWidth,height:window.innerHeight,loginForm:{userName:"",passWord:""},loginRules:{userName:[{required:!0,message:"请输入用户名",trigger:"blur"}],passWord:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},methods:{submitForm:function(){var t=this.loginForm,e=t.passWord,n=t.userName;console.log(e,n)},toRegisterPage:function(){this.$router.push("/register")},drawFrame:function(){requestAnimationFrame(this.drawFrame);this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.createStar(!1),this.stars.forEach(this.moveStar)},createStar:function(t){var e=new Date;if(t)for(var n=0;n<50;n++){var a=3*Math.random()+2,o=new this.Ball(a);o.x=Math.random()*this.canvas.width+1,o.y=Math.random()*this.canvas.height+1,o.color="#ffffff",o.shadowColor=this.shadowColorList[Math.floor(Math.random()*this.shadowColorList.length)],o.direction=this.directionList[Math.floor(Math.random()*this.directionList.length)],this.stars.push(o)}else if(!t&&e-this.last_star_created_time>3e3){for(n=0;n<30;n++)this.stars[n].shadowColor=this.shadowColorList[Math.floor(Math.random()*this.shadowColorList.length)];this.last_star_created_time=e}},moveStar:function(t,e){t.y-this.canvas.height>0?1===Math.floor(2*Math.random())?t.direction="leftTop":t.direction="rightTop":t.y<2?1===Math.floor(2*Math.random())?t.direction="rightBottom":t.direction="leftBottom":t.x<2?1===Math.floor(2*Math.random())?t.direction="rightTop":t.direction="rightBottom":t.x-this.canvas.width>0&&(1===Math.floor(2*Math.random())?t.direction="leftBottom":t.direction="leftTop"),"leftTop"===t.direction?(t.y-=t.radius/this.speed,t.x-=t.radius/this.speed):"rightBottom"===t.direction?(t.y+=t.radius/this.speed,t.x+=t.radius/this.speed):"leftBottom"===t.direction?(t.y+=t.radius/this.speed,t.x-=t.radius/this.speed):"rightTop"===t.direction&&(t.y-=t.radius/this.speed,t.x+=t.radius/this.speed),t.draw(this.context)}},mounted:function(){this.canvas=document.getElementById("myCanvas"),this.context=this.canvas.getContext("2d"),this.createStar(!0),this.drawFrame(),this.$socket.disconnect()}},Zt=Qt,te=(n("75e6"),Object(u["a"])(Zt,Jt,Xt,!1,null,"2cdc584a",null)),ee=te.exports,ne=(n("d3b7"),n("bc3a")),ae=n.n(ne),oe=function(){var t=ae.a;localStorage.token&&(t=ae.a.create({headers:{authorization:localStorage.token}}));return t.interceptors.response.use((function(t){return t.config?(t.headers&&t.headers.authorization&&(localStorage.token=t.headers.authorization),t.data):t}),(function(t){return localStorage.removeItem("token"),Promise.reject(t)})),t},re=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n,a,o=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=o.length>0&&void 0!==o[0]?o[0]:{},n=e.account,a=e.password,t.next=3,oe().post("/api/user/login",{account:n,password:a});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),se={namespaced:!0,state:{isLogin:!1,info:{id:null,account:null,avatar:null,createdAt:null,name:null,password:null,friends:[],groups:[]}},mutations:{login:function(t,e){t.info=Object(y["a"])(Object(y["a"])({},e),{},{friends:[],groups:[]}),t.isLogin=!0},initFriends:function(t,e){t.info.friends=e},initGroups:function(t,e){t.info.groups=e},logout:function(t,e){localStorage.removeItem("token"),t.info={},t.isLogin=!1},addFriend:function(t,e){t.info.friends=[e].concat(Object(M["a"])(t.info.friends))},updateMyInfo:function(t,e){t.info=Object(y["a"])(Object(y["a"])({},t.info),e)}}},ie={namespaced:!0,state:{curChattingTarget:{targetId:null,myId:null,type:"user",data:[],limit:10,page:1},friendChatting:[],groupChatting:[]},mutations:{initFriendChatting:function(t,e){t.friendChatting=e},initGroupChatting:function(t,e){t.groupChatting=e},updateCurChattingTarget:function(t,e){t.curChattingTarget=Object(y["a"])(Object(y["a"])({},t.curChattingTarget),e)}},actions:{}};a["default"].use($["a"]);var ce=new $["a"].Store({state:{},mutations:{},actions:{},modules:{user:se,chatting:ie}});a["default"].use(f["a"]);var ue=[{path:"/identify",name:"identify",component:ee,redirect:"/identify/login",beforeEnter:function(t,e,n){console.log("store.state.user.isLogin"),console.log(ce.state.user.isLogin),ce.state.user.isLogin?n("/"):n()},children:[{path:"/identify/login",name:"login",component:Pt},{path:"/identify/register",name:"register",component:zt}]},{path:"/",name:"Home",component:At,beforeEnter:function(t,e,n){console.log(t,e),ce.state.user.isLogin?n():n("/identify/login")}}],le=new f["a"]({base:"/",routes:ue}),de=le,fe=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n,a,o,r,s,i=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=i.length>0&&void 0!==i[0]?i[0]:{},n=e.account,a=e.password,o=e.name,r=e.avatar,console.log(n,a,o,r),t.next=4,oe().post("/api/user",{account:n,password:a,name:o,avatar:r});case 4:return s=t.sent,t.abrupt("return",s);case 6:case"end":return t.stop()}}),t)}))),pe=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",oe().post("/api/user/whoami"));case 1:case"end":return t.stop()}}),t)}))),ge=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n,a,o,r=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:{},n=e.name,a=e.avatar,t.next=3,oe().put("/api/user",{name:n,avatar:a});case 3:return o=t.sent,t.abrupt("return",o);case 5:case"end":return t.stop()}}),t)}))),he={login:re,register:fe,whoami:pe,updateMyInfo:ge},me=(n("0fae"),n("eb23")),ve=function(t){t.use(W["Upload"]),t.use(W["Dialog"]),t.use(W["Checkbox"]),t.use(W["CheckboxGroup"]),t.use(W["Input"]),t.use(W["Button"]),t.use(W["Form"]),t.use(W["FormItem"]),t.use(W["Row"]),t.use(W["Col"]),t.component("vue-custom-scrollbar",me["a"])},be=(n("77ed"),n("8055")),ye=n.n(be),Ce=n("0be3"),we=n.n(Ce),ke=function(){function t(){Object(Yt["a"])(this,t),this.socket=null}return Object(Kt["a"])(t,[{key:"launch",value:function(){if(void 0!=ce.state.user.info.id){console.log("尽量了");var t=ye()("/api/socket",{timeout:36e5,transportOptions:{polling:{extraHeaders:{authorization:localStorage.token}}}});this.socket=t,console.log("?????????"),this.bindEvent()}else this.disconnect()}},{key:"bindEvent",value:function(){var t=this,e=this.socket;e&&(console.log("&&&&&&&&&&"),console.log(e),window.abc=e,document.body.onunload=function(){console.log("页面要关闭了==============="),t.disconnect()},e.on("connect",(function(t){console.log("连接开启")})),e.on("whoami",(function(t){console.log("我是"),console.log(t)})),e.on("getFriends",(function(t){console.log("朋友数据"),console.log(t),t.status&&ce.commit("user/initFriends",t.data)})),e.on("getGroups",(function(t){console.log("群数据"),console.log(t),t.status&&ce.commit("user/initGroups",t.data)})),e.on("getAllChattingRecord",(function(t){console.log("聊天记录"),console.log(t),t.status&&(ce.commit("chatting/initFriendChatting",t.data.friendChatting),ce.commit("chatting/initGroupChatting",t.data.groupChatting))})),e.on("sendUserChatting",(function(t){console.log("发送给好友消息了，",t)})),e.on("joinUserRoom",(function(t){console.log("加入房间成功"),console.log(t)})),e.on("sendGroupChatting",(function(t){console.log("发送群消息了",t)})),e.on("getGroupChatting",(function(t){if(console.log("某个群发来的消息"),console.log(t),t.status){var n=ce.state.chatting.curChattingTarget.targetId;e.emit("getChatting",{targetId:n,type:"group",getAll:!0})}})),e.on("initComplete",(function(){console.log("@@@@@@@@@@@@@@@"),e.emit("getFriends"),e.emit("getGroups"),e.emit("getAllChattingRecord",{getAll:!0})})),e.on("joinGroupRoom",(function(t){console.log("可以开始群聊了"),console.log(t)})),e.on("disconnect",(function(){console.log("服务端那边断开了")})),e.on("getUserChatting",(function(t){if(console.log("某个好友发来的消息"),console.log("resppppppppp"),console.log(t),t.status){var n=ce.state.user.info.id,a=t.data.send_id===n?t.data.to_user_id:t.data.send_id,o=ce.state.user.info.friends.find((function(t){return t.id===a}));o||(e.emit("getFriends",!0),e.emit("joinUserRoom",a)),e.emit("getChatting",{myId:n,targetId:a,type:"user",getAll:!0})}})),e.on("getChatting",(function(t){console.log("getChatting"),console.log(t),ce.commit("chatting/updateCurChattingTarget",t.data)})),e.on("enquireAddFriend",function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(n){var a,o,r,s,i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(ce.state.user.info.id,n.status){t.next=4;break}return Object(W["Message"])({type:"error",message:n.msg}),t.abrupt("return");case 4:if(a=n.data,o=a.title,r=a.info,s=a.targetData,a.name,i=a.allow,c=a.isFinish,c){t.next=18;break}return t.prev=6,t.next=9,W["MessageBox"].confirm(r,o);case 9:e.emit("enquireAddFriend",{targetAccount:s.account,allow:!0}),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](6),e.emit("enquireAddFriend",{targetAccount:s.account,allow:!1});case 15:t.next=20;break;case 18:Object(W["Message"])({type:i?"success":"warning",message:r}),i&&(e.emit("joinUserRoom",{targetId:s.id}),e.emit("getFriends",!0),e.emit("getChatting",{type:"user",targetId:s.id,getAll:!0}));case 20:case"end":return t.stop()}}),t,null,[[6,12]])})));return function(e){return t.apply(this,arguments)}}()),e.on("backend_error",(function(t){console.log("服务端那边发送错误了"),Object(W["Message"])({type:"error",message:t.msg})})),e.on("backend_info",(function(t){Object(W["Message"])({type:"info",message:t.msg})})),e.on("backend_success",(function(t){Object(W["Message"])({type:"success",message:t.msg})})),e.on("enquireAddGroup",function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(n){var a,o,r,s,i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n.status){t.next=3;break}return Object(W["Message"])({type:"error",message:n.msg}),t.abrupt("return");case 3:if(a=n.data,o=a.allow,r=a.userData,s=a.groupData,i=a.info,c=a.isFinish,c){t.next=17;break}return t.prev=5,t.next=8,W["MessageBox"].confirm(i,"消息提示");case 8:e.emit("enquireAddGroup",{targetId:r.id,targetGroupData:{id:s.id},allow:!0}),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](5),e.emit("enquireAddGroup",{targetId:r.id,targetGroupData:{id:s.id},allow:!1});case 14:t.next=19;break;case 17:Object(W["Message"])({type:o?"success":"warning",message:i}),o&&e.emit("getGroups",!0);case 19:case"end":return t.stop()}}),t,null,[[5,11]])})));return function(e){return t.apply(this,arguments)}}()),e.on("addGroup",(function(t){t.status&&e.emit("getGroups")})),e.on("createGroup_success",function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(n){var a,o,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n.status){t.next=11;break}a=n.data,o=a.inviteTarget,r=a.groupData,e.emit("getGroups",!0),s=0;case 4:if(!(s<o.length)){t.next=11;break}return e.emit("enquireAddGroup",{targetId:o[s].id,newGroup:!1,targetGroupData:r}),t.next=8,we()(100);case 8:s++,t.next=4;break;case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.on("updateMyInfo_success",function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()))}},{key:"disconnect",value:function(){this.socket&&(this.socket.disconnect(),this.socket=null)}},{key:"emit",value:function(){for(var t,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];console.log(n),(t=this.socket).emit.apply(t,n)}},{key:"on",value:function(){var t;(t=this.socket).on.apply(t,arguments)}}]),t}(),xe=new ke,_e=xe;ve(a["default"]),a["default"].use(P.a),a["default"].config.productionTip=!1,a["default"].prototype.$apis=he,a["default"].prototype.$socket=_e,new a["default"]({router:de,store:ce,render:function(t){return t(d)}}).$mount("#app")},"5b23":function(t,e,n){},"5c0b":function(t,e,n){"use strict";n("9c0c")},"5fd6":function(t,e,n){},"75e6":function(t,e,n){"use strict";n("50a2")},"7e68":function(t,e,n){"use strict";n("2f32")},8374:function(t,e,n){"use strict";n("3930")},"839a":function(t,e,n){"use strict";n("2336")},"8e2d":function(t,e,n){"use strict";n("c1db")},"907e":function(t,e,n){},"999b":function(t,e,n){},"9c0c":function(t,e,n){},a517:function(t,e,n){"use strict";n("907e")},ace9:function(t,e,n){"use strict";n("18c4")},b9fb:function(t,e,n){"use strict";n("5fd6")},c1db:function(t,e,n){},e6cf1:function(t,e,n){"use strict";n("5b23")},ed9f:function(t,e,n){"use strict";n("f5db")},f5db:function(t,e,n){},fac7:function(t,e,n){},fe81:function(t,e,n){"use strict";n("fac7")}});
//# sourceMappingURL=app.761014bf.js.map